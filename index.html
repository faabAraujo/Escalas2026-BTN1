<!DOCTYPE html>
<html lang="pt-br" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Escalas 2026</title>
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⛪</text></svg>">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        navy: '#0f172a',
                        gold: '#b45309',
                    }
                }
            }
        }
    </script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Fonte Google: Roboto & Montserrat -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;600;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

    <style>
        /* =========================================
           SISTEMA DE TEMAS (100% Variáveis)
           ========================================= */
        :root {
            /* --- PALETA BASE (CLARO) --- */
            --bg-body: #EEEEEE;        /* Slate 100 */
            --bg-card: #EEEEEE;        /* White */
            --bg-header: #ffffff;      /* White */
            --bg-input: #f8fafc;       /* Slate 50 */
            --bg-hover: #f8fafc;       /* Slate 100 */
            
            --text-main: #292929;      /* Slate 700 */
            --text-heading: #292929;   /* Slate 900 */
            --text-muted: #292929;     /* Slate 500 */
            --text-inverse: #ffffff;   /* White */
            
            --border-color: #d5d5d5;   /* Slate 200 */
            --shadow-color: transparent;
            
            /* --- MARCA & LOGO (CLARO) --- */
            --brand-primary: #333537;  /* Navy (Azul Escuro) */
            --brand-secondary: #b59c2a;/* Gold (Dourado) */
            
            --logo-bg: #30343F;        /* Fundo do ícone da logo */
            --logo-icon: #ffffff;      /* Cor do ícone da logo */
            --logo-title: #30343F;     /* Cor do título "IASD..." */
            --logo-subtitle: #30343F;  /* Cor do subtítulo "Escalas..." */
            
            /* --- ELEMENTOS ESPECÍFICOS (CLARO) --- */
            --badge-bg: #EEEEEE;
            --badge-text: #292929;
            --badge-border: #e6e6e6;
            
            --nav-tab-active: #a98c0d;
            --nav-tab-hover: rgb(48, 52, 63, 0.05);
            
            --card-border-sabado: #a98c0d;
            --card-border-domingo: #0e66af;
            --card-border-padrao: #e3e8ec;
            
            /* Destaque Tabela */
            --highlight-sabado-text: #a98c0d;
            --highlight-domingo-text: #0e66af;
            --highlight-sabado-bg: rgb(169, 140, 13, 0.1); /* Gold com transparência */
            --highlight-domingo-bg: rgb(14, 102, 175, 0.1); /* Navy com transparência */
            
            /* Dashboard Card */
            --dash-bg: #ffffff;
            --dash-border: #b59c2a;
        }

        /* --- PALETA BASE (ESCURO) --- */
        html.dark {
            --bg-body: #131314;
            --bg-card: #131314;
            --bg-header: #1d1d1f;
            --bg-input: #30343F;
            --bg-hover: #1d1e1f;
            
            --text-main: #e3e3e3;
            --text-heading: #e3e3e3;
            --text-muted: #e3e3e3;
            --text-inverse: #131314;
            
            --border-color: #333537;
            --shadow-color: rgb(19, 19, 20, 0.5);
            
            /* --- MARCA & LOGO (ESCURO) --- */
            --brand-primary: #333537;
            --brand-secondary: #b59c2a;
            
            --logo-bg: #30343F;
            --logo-icon: #e3e3e3;
            --logo-title: #e3e3e3;
            --logo-subtitle: #e3e3e3;
            
            /* --- ELEMENTOS ESPECÍFICOS (ESCURO) --- */
            --badge-bg: #333537;
            --badge-text: #e3e3e3;
            --badge-border: #303030;
            
            --nav-tab-active: #b59c2a;
            --nav-tab-hover: rgb(19, 19, 20, 0.5);
            
            --card-border-sabado: #b59c2a;
            --card-border-domingo: #3F88C5;
            --card-border-padrao: #333537;
            
            /* Destaque Tabela */
            --highlight-sabado-text: #b59c2a;
            --highlight-domingo-text: #3F88C5;
            --highlight-sabado-bg: rgb(181, 156, 42, 0.15);
            --highlight-domingo-bg: rgb(63, 136, 197, 0.15);
            
            /* Dashboard Card */
            --dash-bg: #1d1d1f;
            --dash-border: #b59c2a;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            transition: background-color 0.3s ease, color 0.3s ease;
            -webkit-tap-highlight-color: transparent;
        }

        h1, h2, h3, .font-heading {
            font-family: 'Montserrat', sans-serif;
            color: var(--text-heading);
        }
        
        /* Utilitários de Cor CSS Variables */
        .text-theme-main { color: var(--text-main); }
        .text-theme-muted { color: var(--text-muted); }
        .text-theme-heading { color: var(--text-heading); }
        .bg-theme-card { background-color: var(--bg-card); }
        
        .shadow-soft {
            box-shadow: 0 4px 6px -1px var(--shadow-color), 0 2px 4px -1px var(--shadow-color);
        }

        /* Tabs */
        .tab-btn {
            position: relative;
            color: var(--text-muted);
            font-weight: 600;
            padding: 12px 20px;
            transition: all 0.3s;
            white-space: nowrap;
            border-bottom: 2px solid transparent;
        }
        .tab-btn:hover {
            color: var(--nav-tab-active);
            background-color: var(--nav-tab-hover);
        }
        .tab-btn.active {
            color: var(--nav-tab-active);
            border-bottom-color: var(--nav-tab-active);
        }

        /* Tabela */
        .custom-table {
            border-collapse: separate;
            border-spacing: 0;
            width: 100%;
        }
        .custom-table th {
            background-color: var(--bg-body);
            color: var(--text-muted);
            font-family: 'Montserrat', sans-serif;
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            padding: 16px;
            border-bottom: 1px solid var(--border-color);
            font-weight: 700;
        }
        .custom-table td {
            padding: 16px;
            border-bottom: 1px solid var(--border-color);
            vertical-align: middle;
            background-color: var(--bg-card);
            transition: background-color 0.2s;
            color: var(--text-main);
        }
        .custom-table tr:hover td {
            background-color: var(--bg-hover);
        }
        
        .custom-table td.col-highlight {
            background-color: var(--bg-hover);
            border-right: 1px solid var(--border-color);
            position: relative;
        }
        
        /* Indicadores Coloridos */
        .date-indicator-sab { border-left: 4px solid var(--card-border-sabado); }
        .date-indicator-dom { border-left: 4px solid var(--card-border-domingo); }
        .date-indicator-other { border-left: 4px solid var(--card-border-padrao); }

        .badge-ministerio {
            display: inline-flex;
            align-items: center;
            background-color: var(--badge-bg);
            color: var(--badge-text);
            border: 1px solid var(--badge-border);
            font-size: 0.75rem;
            padding: 4px 10px;
            border-radius: 6px;
            font-weight: 600;
            letter-spacing: 0.03em;
        }

        /* Mobile Card */
        .mobile-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 16px;
            box-shadow: 0 2px 5px var(--shadow-color);
            margin-bottom: 16px;
            border: 1px solid var(--border-color);
            border-left-width: 5px;
        }
        .mobile-card-sab { border-left-color: var(--card-border-sabado); }
        .mobile-card-dom { border-left-color: var(--card-border-domingo); }
        .mobile-card-other { border-left-color: var(--card-border-padrao); }

        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-top: 12px;
        }
        .music-block {
            grid-column: span 2;
            background-color: var(--bg-body);
            padding: 12px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .info-item {
            background-color: var(--bg-body);
            padding: 10px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }
        .info-label {
            font-size: 0.65rem;
            text-transform: uppercase;
            color: var(--text-muted);
            margin-bottom: 4px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        /* Dashboard de Hoje */
        .dashboard-card {
            background-color: var(--dash-bg);
            border: 2px solid var(--dash-border);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
            box-shadow: 0 8px 15px var(--shadow-color);
            position: relative;
            overflow: hidden;
        }
        
        .dashboard-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
        }

        .today-badge {
            background-color: var(--brand-secondary);
            color: #ffffff;
            font-size: 0.7rem;
            padding: 4px 12px;
            border-radius: 20px;
            text-transform: uppercase;
            font-weight: 800;
            letter-spacing: 0.05em;
        }
        
        .theme-toggle-btn {
            background-color: var(--bg-body);
            border: 1px solid var(--border-color);
            color: var(--text-heading);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s;
        }
        .theme-toggle-btn:hover {
            transform: scale(1.1);
            border-color: var(--brand-primary);
            color: var(--brand-primary);
        }
    </style>
</head>
<body class="flex flex-col min-h-screen transition-colors duration-300">

    <!-- Cabeçalho 
         CORREÇÃO: Alterado de 'sticky top-0' para 'relative md:sticky md:top-0'.
         Isso remove o comportamento fixo no celular (evitando sobreposição/ocupação de tela)
         mas mantém o menu fixo no computador onde há espaço.
         Adicionado estilo de background explícito.
    -->
    <header style="background-color: var(--bg-header);" class="relative md:sticky md:top-0 z-50 border-b border-[var(--border-color)] shadow-sm transition-colors duration-300">
        <!-- CORREÇÃO: Adicionado 'justify-center' e removido o comportamento de expansão total para centralizar o bloco -->
        <div class="container mx-auto px-4 py-4 flex flex-col md:flex-row items-center justify-center gap-4 md:gap-8">
            <div class="flex items-center justify-between w-full md:w-auto">
                <div class="flex items-center gap-3">
                    <!-- Logo Box com Cor Variável -->
                    <div style="background-color: var(--logo-bg); color: var(--logo-icon);" class="w-10 h-10 md:w-12 md:h-12 rounded-lg flex items-center justify-center shadow-lg transform rotate-3 flex-shrink-0 transition-colors duration-300">
                        <i class="fas fa-church text-lg md:text-xl"></i>
                    </div>
                    <div>
                        <!-- Título e Subtítulo com Cores Variáveis -->
                        <h1 style="color: var(--logo-title);" class="text-lg md:text-xl font-bold leading-tight tracking-tight transition-colors duration-300">IASD TN1</h1>
                        <p style="color: var(--logo-subtitle);" class="text-[10px] md:text-xs font-semibold uppercase tracking-widest transition-colors duration-300">Escalas Online</p>
                    </div>
                </div>
                
                <button onclick="toggleTheme()" class="theme-toggle-btn md:ml-4" aria-label="Alterar Tema">
                    <i class="fas fa-moon block dark:hidden"></i>
                    <i class="fas fa-sun hidden dark:block text-yellow-400"></i>
                </button>
            </div>

            <!-- CORREÇÃO: Removido 'flex-grow' e definido largura fixa para desktop para manter centralização -->
            <div class="w-full md:w-[450px]">
                <div class="relative w-full group">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <i class="fas fa-search text-[var(--text-muted)]"></i>
                    </div>
                    <input type="text" id="searchInput" placeholder="Buscar nome ou data..." 
                        class="w-full pl-10 pr-4 py-2.5 rounded-lg border border-[var(--border-color)] bg-[var(--input-bg)] text-[var(--text-main)] placeholder-[var(--text-muted)] focus:outline-none focus:ring-2 focus:ring-[var(--brand-primary)] transition-all shadow-inner text-sm">
                    <button id="clearBtn" class="hidden absolute inset-y-0 right-0 pr-3 flex items-center text-[var(--text-muted)] hover:text-red-500 cursor-pointer p-2" onclick="clearSearch()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <div style="background-color: var(--bg-header);" class="border-t border-[var(--border-color)] shadow-sm md:shadow-none transition-colors duration-300">
            <div class="container mx-auto px-4 py-2 md:py-0">
                <div class="md:hidden relative">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <i class="fas fa-filter text-[var(--logo-subtitle)] text-xs"></i>
                    </div>
                    <select id="tabsSelect" onchange="switchTab(this.value)" 
                        class="block w-full pl-9 pr-10 py-3 text-sm font-semibold text-[var(--text-heading)] bg-[var(--input-bg)] border border-[var(--border-color)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--brand-primary)] appearance-none shadow-sm transition-all">
                    </select>
                    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-4 text-[var(--text-muted)]">
                        <i class="fas fa-chevron-down text-xs"></i>
                    </div>
                </div>

                <!-- CORREÇÃO: Mantido 'justify-center' para centralizar a navegação no desktop -->
                <nav class="hidden md:flex justify-center space-x-1 overflow-x-auto scrollbar-hide" id="tabsContainer"></nav>
            </div>
        </div>
    </header>

    <!-- Conteúdo Principal -->
    <main class="flex-grow container mx-auto px-4 py-6 md:py-8 max-w-7xl">
        <div class="flex flex-col md:flex-row justify-between items-end mb-6 gap-2 md:gap-4">
            <div>
                <span class="inline-block px-3 py-1 bg-[var(--bg-body)] text-[var(--text-muted)] text-xs font-bold rounded-full mb-2 uppercase tracking-wide border border-[var(--border-color)]">Agenda Mensal</span>
                <h2 class="text-2xl md:text-3xl font-bold" id="pageTitle">Visão Geral</h2>
            </div>
            <div class="flex justify-between w-full md:w-auto items-end">
                <div class="md:text-right">
                    <p class="text-xs md:text-sm font-medium text-[var(--text-muted)] uppercase tracking-wide">Mês Vigente</p>
                    <p style="color: var(--logo-subtitle);" class="text-xl md:text-2xl font-bold">Janeiro 2026</p>
                </div>
                <div class="md:hidden text-xs text-[var(--text-muted)] italic">
                    <i class="fas fa-mobile-alt mr-1"></i>Modo Mobile
                </div>
            </div>
        </div>

        <div id="searchFeedback" class="hidden mb-6 bg-[var(--bg-card)] border border-[var(--border-color)] text-[var(--text-main)] rounded-lg p-4 shadow-lg flex items-center justify-between transform transition-all">
            <div class="flex items-center">
                <div style="color: var(--brand-secondary);" class="bg-[var(--bg-body)] p-2 rounded-full mr-3 border border-[var(--border-color)]">
                    <i class="fas fa-search"></i>
                </div>
                <div class="text-sm">
                    <p class="opacity-75 text-xs text-[var(--text-muted)]">Resultados para:</p>
                    <p style="color: var(--brand-secondary);" class="font-bold text-base" id="searchTermDisplay"></p>
                </div>
            </div>
            <button onclick="clearSearch()" class="text-xs bg-[var(--bg-body)] hover:bg-[var(--bg-hover)] text-[var(--text-main)] border border-[var(--border-color)] px-3 py-2 rounded transition-colors whitespace-nowrap ml-2">
                Limpar
            </button>
        </div>

        <div id="contentContainer"></div>

        <div id="emptyState" class="hidden flex flex-col items-center justify-center py-16 text-center">
            <div class="bg-[var(--bg-body)] border border-[var(--border-color)] rounded-full p-6 mb-4">
                <i class="fas fa-search-minus text-[var(--text-muted)] text-4xl"></i>
            </div>
            <h3 class="text-lg font-bold">Nenhum registro encontrado</h3>
            <p class="text-[var(--text-muted)] mt-1 max-w-xs mx-auto text-sm">Tente buscar por outro termo ou limpe o filtro para ver tudo.</p>
            <button onclick="clearSearch()" style="color: var(--brand-secondary);" class="mt-4 font-bold text-sm hover:underline">Ver Agenda Completa</button>
        </div>
    </main>

    <footer class="py-8 text-center bg-[var(--header-bg)] border-t border-[var(--border-color)] mt-8 transition-colors duration-300">
        <div class="flex flex-col items-center">
            <i class="fas fa-church text-[var(--text-muted)] text-2xl mb-3"></i>
            <p class="text-xs text-[var(--text-muted)] font-medium tracking-wide">&copy; 2026 Igreja Adventista do Sétimo Dia - Tancredo Neves 1</p>
            <p class="text-[10px] text-[var(--text-muted)] mt-1">Deus seja louvado</p>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
        } else {
            document.documentElement.classList.remove('dark');
        }

        function toggleTheme() {
            if (document.documentElement.classList.contains('dark')) {
                document.documentElement.classList.remove('dark');
                localStorage.theme = 'light';
            } else {
                document.documentElement.classList.add('dark');
                localStorage.theme = 'dark';
            }
        }

        const dataBase = [
            {
                id: "ministerios",
                label: "Ministérios",
                category: "Ministérios",
                icon: "fa-bullhorn",
                items: [
                    { date: "07/01 (Qua)", role: "Direção", name: "Profecia" },
                    { date: "14/01 (Qua)", role: "Direção", name: "Adolescente e Criança" },
                    { date: "21/01 (Qua)", role: "Direção", name: "Lar e Família" },
                    { date: "28/01 (Qua)", role: "Direção", name: "MM (Mulher)" },
                    { date: "10/01 (Sáb)", role: "Direção", name: "Ministério Pessoal" },
                    { date: "17/01 (Sáb)", role: "Direção", name: "Diretoria" },
                    { date: "24/01 (Sáb)", role: "Direção", name: "Escola Sabatina" },
                    { date: "11/01 (Dom)", role: "Direção", name: "Aventureiros" },
                    { date: "18/01 (Dom)", role: "Direção", name: "Desbravador" },
                    { date: "25/01 (Dom)", role: "Direção", name: "Jovens" }
                ]
            },
            {
                id: "musica",
                label: "Música / Louvor",
                category: "Música",
                icon: "fa-music",
                items: [
                    { date: "11/01 (Dom)", role: "Cânticos", name: "Bia / Cleonice", songs: ["1. SOU AVENTUREIRO", "2. EU SOU FELIZ", "3. QUEM FEZ"] },
                    { date: "18/01 (Dom)", role: "Cânticos", name: "Mateus / Karina", songs: ["1. INABALÁVEL", "2. ENQUANTO EU VIVER", "3. ESPERA EM DEUS"] },
                    { date: "25/01 (Dom)", role: "Cânticos", name: "Evini / Vinícius", songs: ["1. MISSÃO", "2. EU PERTENÇO A LUZ", "3. ESTOU AQUI"] },
                    { date: "07/01 (Qua)", role: "Cânticos", name: "Thor / Mateus", songs: ["1. MAIOR QUE TUDO", "2. NÃO DESISTIR", "3. ALVO MAIS QUE A NEVE"] },
                    { date: "14/01 (Qua)", role: "Cânticos", name: "Helen / Camila", songs: ["1. CHEGOU A HORA", "2. FIRME NAS PROMESSAS", "3. ENTREGO A TI"] },
                    { date: "21/01 (Qua)", role: "Cânticos", name: "Alice / Evelyn", songs: ["1. O SANTO ESPÍRITO", "2. A ESPERANÇA É JESUS", "3. SALMOS DOS SALMOS"] },
                    { date: "28/01 (Qua)", role: "Cânticos", name: "Camila / Angela", songs: ["1. REI DOS REIS", "2. INFINITA GRAÇA", "3. RENOVA-ME"] },
                    { date: "10/01 (Sáb)", role: "Cânticos", name: "Artur / Fabiano", songs: ["1. OH, QUE ESPERANÇA", "2. NÃO HÁ O QUE TEMER", "3. DEUS NOS OUVIRA"] },
                    { date: "17/01 (Sáb)", role: "Cânticos", name: "Gil / Angela", songs: ["1. EM TUAS MÃOS", "2. SANTO SOMENTE É O SENHOR", "3. MANANCIAL"] },
                    { date: "24/01 (Sáb)", role: "Cânticos", name: "Lucia / Helen", songs: ["1. CONFIEI NO MEU SENHOR", "2. FALAR COM DEUS", "3. DEUS NOS OUVIRÁ"] },
                    { date: "31/01 (Sáb)", role: "Cânticos", name: "Alice / Ana", songs: ["1. ELE É EXALTADO", "2. VEM, SANTO ESPÍRITO", "3. QUASE NO LAR"] }
                ]
            },
            {
                id: "sonoplastia",
                label: "Sonoplastia",
                category: "Sonoplastia",
                icon: "fa-sliders-h",
                items: [
                    { date: "07/01 (Qua)", role: "Mesa de Som", name: "Mateus Filipe" },
                    { date: "10/01 (Sáb)", role: "Mesa de Som", name: "Ana Paula" },
                    { date: "11/01 (Dom)", role: "Mesa de Som", name: "Karina Bezerra" },
                    { date: "14/01 (Qua)", role: "Mesa de Som", name: "Mateus Filipe" },
                    { date: "17/01 (Sáb)", role: "Mesa de Som", name: "Fabiano Araújo" },
                    { date: "18/01 (Dom)", role: "Mesa de Som", name: "Evelyn Thaina" },
                    { date: "21/01 (Qua)", role: "Mesa de Som", name: "Mateus Filipe" },
                    { date: "24/01 (Sáb)", role: "Mesa de Som", name: "Karina Bezerra" },
                    { date: "25/01 (Dom)", role: "Mesa de Som", name: "Evelyn Thaina" },
                    { date: "28/01 (Qua)", role: "Mesa de Som", name: "Mateus Filipe" },
                    { date: "31/01 (Sáb)", role: "Mesa de Som", name: "Karina Bezerra" }
                ]
            },
            {
                id: "dizimos",
                label: "Dízimos",
                category: "Dízimos",
                icon: "fa-hand-holding-dollar",
                items: [
                    { date: "10/01 (Sáb)", role: "Recolhimento", name: "Cleonice" },
                    { date: "17/01 (Sáb)", role: "Recolhimento", name: "Camila" },
                    { date: "24/01 (Sáb)", role: "Recolhimento", name: "Angela" },
                    { date: "31/01 (Sáb)", role: "Recolhimento", name: "Mina" },
                    { date: "11/01 (Dom)", role: "Recolhimento", name: "Welma" },
                    { date: "18/01 (Dom)", role: "Recolhimento", name: "Helen" },
                    { date: "25/01 (Dom)", role: "Recolhimento", name: "Mina" },
                    { date: "07/01 (Qua)", role: "Recolhimento", name: "Angela" },
                    { date: "14/01 (Qua)", role: "Recolhimento", name: "Gil" },
                    { date: "21/01 (Qua)", role: "Recolhimento", name: "Helen" },
                    { date: "28/01 (Qua)", role: "Recolhimento", name: "Camila" }
                ]
            },
            {
                id: "diaconos",
                label: "Diáconos",
                category: "Diáconos",
                icon: "fa-user-tie",
                items: [
                    { date: "10/01 (Sáb)", role: "Plantão", name: "Fabiano" },
                    { date: "17/01 (Sáb)", role: "Plantão", name: "Damião" },
                    { date: "24/01 (Sáb)", role: "Plantão", name: "Elivonaldo" },
                    { date: "31/01 (Sáb)", role: "Plantão", name: "Ednaldo" },
                    { date: "11/01 (Dom)", role: "Plantão", name: "Elivonaldo" },
                    { date: "18/01 (Dom)", role: "Plantão", name: "Ednaldo" },
                    { date: "25/01 (Dom)", role: "Plantão", name: "Givaldo" },
                    { date: "07/01 (Qua)", role: "Plantão", name: "Ednaldo" },
                    { date: "14/01 (Qua)", role: "Plantão", name: "Givaldo" },
                    { date: "21/01 (Qua)", role: "Plantão", name: "Fabiano" },
                    { date: "28/01 (Qua)", role: "Plantão", name: "Damião" }
                ]
            },
            {
                id: "recepcao",
                label: "Recepção",
                category: "Recepção",
                icon: "fa-heart",
                items: [
                    { date: "10/01 (Sáb)", role: "Equipe", name: "Mina e Igreja" },
                    { date: "17/01 (Sáb)", role: "Equipe", name: "Welma e Igreja" },
                    { date: "24/01 (Sáb)", role: "Equipe", name: "Evini e Igreja" },
                    { date: "31/01 (Sáb)", role: "Equipe", name: "Angela e Igreja" },
                    { date: "11/01 (Dom)", role: "Equipe", name: "Welma" },
                    { date: "18/01 (Dom)", role: "Equipe", name: "Evini" },
                    { date: "25/01 (Dom)", role: "Equipe", name: "Equipe Igreja" },
                    { date: "07/01 (Qua)", role: "Equipe", name: "Equipe Igreja" },
                    { date: "14/01 (Qua)", role: "Equipe", name: "Equipe Igreja" },
                    { date: "21/01 (Qua)", role: "Equipe", name: "Equipe Igreja" },
                    { date: "28/01 (Qua)", role: "Equipe", name: "Equipe Igreja" }
                ]
            },
            {
                id: "adoracao_infantil",
                label: "Adoração Infantil",
                category: "Adoração Infantil",
                icon: "fa-child",
                items: [
                    { date: "10/01 (Sáb)", role: "História", name: "Helen" },
                    { date: "17/01 (Sáb)", role: "História", name: "Camila" },
                    { date: "24/01 (Sáb)", role: "História", name: "Gil" },
                    { date: "31/01 (Sáb)", role: "História", name: "Fabiano" }
                ]
            },
            {
                id: "limpeza",
                label: "Limpeza",
                category: "Limpeza",
                icon: "fa-broom",
                items: [
                    { date: "09/01 (Sex)", role: "Equipe", name: "Helen" },
                    { date: "16/01 (Sex)", role: "Equipe", name: "Mina" },
                    { date: "23/01 (Sex)", role: "Equipe", name: "Cleonice" },
                    { date: "30/01 (Sex)", role: "Equipe", name: "Sandra" },
                    { date: "11/01 (Dom)", role: "Equipe", name: "Gil" },
                    { date: "18/01 (Dom)", role: "Equipe", name: "Welma" },
                    { date: "25/01 (Dom)", role: "Equipe", name: "Duda" },
                    { date: "07/01 (Qua)", role: "Equipe", name: "Angela" },
                    { date: "14/01 (Qua)", role: "Equipe", name: "Lúcia" },
                    { date: "21/01 (Qua)", role: "Equipe", name: "Dilma" },
                    { date: "28/01 (Qua)", role: "Equipe", name: "Helen" }
                ]
            }
        ];

        let currentTab = 'geral';
        const searchInput = document.getElementById('searchInput');
        const clearBtn = document.getElementById('clearBtn');
        const contentContainer = document.getElementById('contentContainer');
        const pageTitle = document.getElementById('pageTitle');
        
        // Define uma data manual apenas para teste (já que estamos fora de Jan 2026).
        // Se quiser usar a data real do sistema, deixe como null.
        // Exemplo: '10/01 (Sáb)'
        const forceDateForTesting = null;

        function normalizeString(str) {
            return str ? str.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase() : "";
        }

        function getDateSortValue(dateStr) {
            const parts = dateStr.split(' ')[0].split('/');
            return parseInt(parts[1]) * 100 + parseInt(parts[0]);
        }
        
        // Função para obter a data formatada de hoje (DD/MM (Dia))
        function getCurrentFormattedDate() {
            if (forceDateForTesting) return forceDateForTesting;

            const date = new Date();
            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const weekDays = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb'];
            const weekDay = weekDays[date.getDay()];
            
            return `${day}/${month} (${weekDay})`;
        }

        function getMergedData() {
            const events = {};
            dataBase.forEach(cat => {
                cat.items.forEach(item => {
                    if (!events[item.date]) {
                        events[item.date] = {
                            dateStr: item.date,
                            sortValue: getDateSortValue(item.date),
                            ministerio: null,
                            dizimos: null,
                            diaconos: null,
                            recepcao: null,
                            limpeza: null,
                            musica_canticos: null,
                            musica_louvores: null,
                            sonoplastia: null,
                            adoracao: null
                        };
                    }
                    if(cat.id === 'ministerios') events[item.date].ministerio = item.name;
                    if(cat.id === 'dizimos') events[item.date].dizimos = item.name;
                    if(cat.id === 'diaconos') events[item.date].diaconos = item.name;
                    if(cat.id === 'recepcao') events[item.date].recepcao = item.name;
                    if(cat.id === 'limpeza') events[item.date].limpeza = item.name;
                    if(cat.id === 'adoracao_infantil') events[item.date].adoracao = item.name;
                    if(cat.id === 'musica') {
                        events[item.date].musica_canticos = item.name;
                        events[item.date].musica_louvores = item.songs;
                    }
                    if(cat.id === 'sonoplastia') events[item.date].sonoplastia = item.name;
                });
            });
            return Object.values(events).sort((a, b) => a.sortValue - b.sortValue);
        }

        function renderTabs() {
            const tabs = [
                { id: 'geral', label: 'Visão Geral' },
                ...dataBase.map(db => ({ id: db.id, label: db.category }))
            ];

            const tabsContainer = document.getElementById('tabsContainer');
            if (tabsContainer) {
                tabsContainer.innerHTML = tabs.map(tab => `
                    <button 
                        onclick="switchTab('${tab.id}')"
                        class="tab-btn ${currentTab === tab.id ? 'active' : ''}"
                    >
                        ${tab.label}
                    </button>
                `).join('');
            }

            const tabsSelect = document.getElementById('tabsSelect');
            if (tabsSelect) {
                tabsSelect.innerHTML = tabs.map(tab => `
                    <option value="${tab.id}" ${currentTab === tab.id ? 'selected' : ''}>
                        ${tab.label}
                    </option>
                `).join('');
            }
        }

        function switchTab(tabId) {
            currentTab = tabId;
            renderTabs();
            renderContent(searchInput.value);
            
            if(tabId === 'geral') pageTitle.textContent = "Visão Geral";
            else {
                const category = dataBase.find(d => d.id === tabId);
                pageTitle.textContent = category ? category.label : "";
            }
        }

        function renderContent(filterQuery = "") {
            const normalizedQuery = normalizeString(filterQuery);
            contentContainer.innerHTML = '';
            
            if (filterQuery) {
                document.getElementById('searchFeedback').classList.remove('hidden');
                document.getElementById('searchTermDisplay').textContent = filterQuery;
                clearBtn.classList.remove('hidden');
            } else {
                document.getElementById('searchFeedback').classList.add('hidden');
                clearBtn.classList.add('hidden');
            }

            if (currentTab === 'geral') {
                const mergedData = getMergedData();
                const currentFormattedDate = getCurrentFormattedDate();
                
                // --- DASHBOARD LOGIC START ---
                // Find today's data
                const todayData = mergedData.find(d => d.dateStr === currentFormattedDate);
                let dashboardHTML = '';

                // Only show dashboard if it's the general tab, no search is active (or search matches today), and we found data
                if (!filterQuery && todayData) {
                     const showDashItem = (label, val, icon) => {
                        if(!val) return '';
                        return `
                        <div class="flex items-center p-3 bg-[var(--bg-body)] rounded-lg border border-[var(--border-color)]">
                            <div class="w-8 h-8 rounded-full bg-[var(--badge-bg)] flex items-center justify-center mr-3 text-[var(--brand-secondary)] shrink-0 shadow-sm">
                                <i class="fas ${icon} text-sm"></i>
                            </div>
                            <div>
                                <p class="text-[10px] uppercase font-bold text-[var(--text-muted)] tracking-wide">${label}</p>
                                <p class="text-sm font-bold text-[var(--text-main)] leading-tight">${val}</p>
                            </div>
                        </div>`;
                    };

                    const showDashSongs = (songs) => {
                        if (!songs || songs.length === 0) return '';
                        return `
                        <div class="col-span-1 md:col-span-2 p-3 bg-[var(--bg-body)] rounded-lg border border-[var(--border-color)]">
                            <div class="flex items-center mb-2">
                                <i class="fas fa-list-ol text-[var(--brand-secondary)] mr-2"></i>
                                <p class="text-[10px] uppercase font-bold text-[var(--text-muted)] tracking-wide">Louvores</p>
                            </div>
                            <ul class="text-xs font-semibold text-[var(--text-main)] grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-1">
                                ${songs.map(s => `<li>${s}</li>`).join('')}
                            </ul>
                        </div>`;
                    };

                    dashboardHTML = `
                    <div class="dashboard-card fade-in">
                        <div class="dashboard-header">
                            <div class="flex items-center gap-3">
                                <span class="today-badge">Hoje</span>
                                <h3 class="text-lg md:text-xl font-black text-[var(--text-heading)] font-heading uppercase">${todayData.dateStr}</h3>
                            </div>
                            ${todayData.ministerio ? `<span class="badge-ministerio shadow-sm">${todayData.ministerio}</span>` : ''}
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3">
                            ${showDashItem('Sonoplastia', todayData.sonoplastia, 'fa-sliders-h')}
                            ${showDashItem('Cânticos', todayData.musica_canticos, 'fa-music')}
                            ${showDashItem('Adoração Inf.', todayData.adoracao, 'fa-child')}
                            ${showDashItem('Dízimos', todayData.dizimos, 'fa-hand-holding-dollar')}
                            ${showDashItem('Diáconos', todayData.diaconos, 'fa-user-tie')}
                            ${showDashItem('Recepção', todayData.recepcao, 'fa-heart')}
                            ${showDashItem('Limpeza', todayData.limpeza, 'fa-broom')}
                            ${showDashSongs(todayData.musica_louvores)}
                        </div>
                    </div>
                    `;
                }
                // --- DASHBOARD LOGIC END ---

                const filteredData = mergedData.filter(day => {
                    if (!filterQuery) return true;
                    const allValues = [
                        day.dateStr, day.ministerio, day.dizimos, day.diaconos, 
                        day.recepcao, day.limpeza, day.musica_canticos, day.sonoplastia,
                        day.adoracao
                    ];
                    if (day.musica_louvores) allValues.push(...day.musica_louvores);
                    
                    return allValues.some(val => 
                        val && typeof val === 'string' && normalizeString(val).includes(normalizedQuery)
                    );
                });

                if (filteredData.length === 0) {
                    document.getElementById('emptyState').classList.remove('hidden');
                    return;
                } else {
                    document.getElementById('emptyState').classList.add('hidden');
                }

                const desktopHTML = `
                <div class="hidden md:block bg-[var(--bg-card)] rounded-xl shadow-soft overflow-hidden border border-[var(--border-color)]">
                    <div class="overflow-x-auto">
                        <table class="custom-table text-left">
                            <thead>
                                <tr>
                                    <th class="w-1/6 border-r border-[var(--border-color)]">Data / Responsável</th>
                                    <th class="text-center"><i style="color: var(--brand-secondary);" class="fas fa-sliders-h mr-1"></i> Som</th>
                                    <th class="text-center"><i style="color: var(--brand-secondary);" class="fas fa-music mr-1"></i> Cânticos</th>
                                    <th class="w-1/6 text-center"><i style="color: var(--brand-secondary);" class="fas fa-list-ol mr-1"></i> Louvor</th>
                                    <th class="text-center"><i style="color: var(--brand-secondary);" class="fas fa-hand-holding-dollar mr-1"></i> Dízimos</th>
                                    <th class="text-center"><i style="color: var(--brand-secondary);" class="fas fa-user-tie mr-1"></i> Diáconos</th>
                                    <th class="text-center"><i style="color: var(--brand-secondary);" class="fas fa-heart mr-1"></i> Recepção</th>
                                    <th class="text-center"><i style="color: var(--brand-secondary);" class="fas fa-child mr-1"></i> Adoração Inf.</th>
                                    <th class="text-center"><i style="color: var(--brand-secondary);" class="fas fa-broom mr-1"></i> Limpeza</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${filteredData.map(day => {
                                    let dateColorClass = "";
                                    let indicatorClass = "date-indicator-other";
                                    let dateStyle = "color: var(--text-muted);";
                                    let rowBgStyle = "";
                                    
                                    if(day.dateStr.includes('Sáb')) { 
                                        dateStyle = "color: var(--highlight-sabado-text); font-weight: 700;"; 
                                        indicatorClass = "date-indicator-sab";
                                        rowBgStyle = "background-color: var(--highlight-sabado-bg);";
                                    }
                                    if(day.dateStr.includes('Dom')) { 
                                        dateStyle = "color: var(--highlight-domingo-text); font-weight: 700;"; 
                                        indicatorClass = "date-indicator-dom";
                                        rowBgStyle = "background-color: var(--highlight-domingo-bg);";
                                    }
                                    
                                    const ministerioHtml = day.ministerio 
                                        ? `<div class="mt-2"><span class="badge-ministerio">${day.ministerio}</span></div>` 
                                        : `<span class="block text-xs text-[var(--text-muted)] mt-2 font-light italic">Sem direção</span>`;
                                    
                                    const makeCell = (val) => val ? `<span class="font-medium text-[var(--text-main)] text-sm">${val}</span>` : `<span class="text-[var(--text-muted)] text-xs">•</span>`;
                                    
                                    const makeSongsList = (songs) => {
                                        if (!songs || songs.length === 0) return `<span class="text-[var(--text-muted)] text-xs">•</span>`;
                                        return `<ul class="text-xs text-[var(--text-main)] space-y-1">${songs.map(s => `<li>${s}</li>`).join('')}</ul>`;
                                    };

                                    return `
                                        <tr style="${rowBgStyle}">
                                            <td class="col-highlight align-top ${indicatorClass} pl-4">
                                                <span style="${dateStyle}" class="text-sm uppercase tracking-wider block font-heading">${day.dateStr}</span>
                                                ${ministerioHtml}
                                            </td>
                                            <td class="text-center align-top border-r border-[var(--border-color)]">${makeCell(day.sonoplastia)}</td>
                                            <td class="text-center align-top border-r border-[var(--border-color)]">${makeCell(day.musica_canticos)}</td>
                                            <td class="align-top border-r border-[var(--border-color)] p-3">${makeSongsList(day.musica_louvores)}</td>
                                            <td class="text-center align-top border-r border-[var(--border-color)]">${makeCell(day.dizimos)}</td>
                                            <td class="text-center align-top border-r border-[var(--border-color)]">${makeCell(day.diaconos)}</td>
                                            <td class="text-center align-top border-r border-[var(--border-color)]">${makeCell(day.recepcao)}</td>
                                            <td class="text-center align-top border-r border-[var(--border-color)]">${makeCell(day.adoracao)}</td>
                                            <td class="text-center align-top">${makeCell(day.limpeza)}</td>
                                        </tr>
                                    `;
                                }).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>`;

                const mobileHTML = `
                <div class="md:hidden space-y-4">
                    ${filteredData.map(day => {
                        let borderColorClass = "mobile-card-other";
                        let dateStyle = "color: var(--text-muted);";
                        
                        if(day.dateStr.includes('Sáb')) { borderColorClass = "mobile-card-sab"; dateStyle = "color: var(--highlight-sabado-text);"; }
                        if(day.dateStr.includes('Dom')) { borderColorClass = "mobile-card-dom"; dateStyle = "color: var(--highlight-domingo-text);"; }
                        
                        const showItem = (label, val, icon) => {
                            if(!val) return '';
                            return `
                            <div class="info-item">
                                <span class="info-label"><i style="color: var(--text-muted);" class="fas ${icon}"></i> ${label}</span>
                                <span class="text-sm font-semibold text-[var(--text-main)] leading-tight block">${val}</span>
                            </div>`;
                        };

                        const showSongs = (songs) => {
                            if (!songs || songs.length === 0) return '';
                            return `
                            <div class="music-block">
                                <span class="info-label"><i class="fas fa-list-ol"></i> Louvor (Músicas)</span>
                                <ul class="text-sm font-semibold text-[var(--text-main)] space-y-1 mt-1">
                                    ${songs.map(s => `<li>${s}</li>`).join('')}
                                </ul>
                            </div>`;
                        };

                        return `
                        <div class="mobile-card ${borderColorClass}">
                            <div class="flex flex-col mb-3">
                                <span style="${dateStyle}" class="text-lg font-black font-heading tracking-wide">${day.dateStr}</span>
                                ${day.ministerio ? `<div class="mt-1"><span class="badge-ministerio">${day.ministerio}</span></div>` : ''}
                            </div>
                            
                            <div class="info-grid">
                                ${showItem('Sonoplastia', day.sonoplastia, 'fa-sliders-h')}
                                ${showItem('Cânticos', day.musica_canticos, 'fa-music')}
                                ${showSongs(day.musica_louvores)}
                                ${showItem('Adoração Infantil', day.adoracao, 'fa-child')}
                                ${showItem('Dízimos', day.dizimos, 'fa-hand-holding-dollar')}
                                ${showItem('Diáconos', day.diaconos, 'fa-user-tie')}
                                ${showItem('Recepção', day.recepcao, 'fa-heart')}
                                ${showItem('Limpeza', day.limpeza, 'fa-broom')}
                            </div>
                        </div>`;
                    }).join('')}
                </div>`;

                contentContainer.innerHTML = dashboardHTML + desktopHTML + mobileHTML;

            } else {
                const categoryData = dataBase.find(d => d.id === currentTab);
                let items = [...categoryData.items].sort((a,b) => getDateSortValue(a.date) - getDateSortValue(b.date));

                if(filterQuery) {
                    items = items.filter(item => {
                       if (typeof item.name === 'string' && normalizeString(item.name).includes(normalizedQuery)) return true;
                       if (normalizeString(item.date).includes(normalizedQuery)) return true;
                       if (item.songs && item.songs.some(s => normalizeString(s).includes(normalizedQuery))) return true;
                       return false;
                    });
                }

                if (items.length === 0) {
                    document.getElementById('emptyState').classList.remove('hidden');
                    return;
                } else {
                    document.getElementById('emptyState').classList.add('hidden');
                }

                contentContainer.innerHTML = `
                <div class="bg-[var(--bg-card)] rounded-xl shadow-soft overflow-hidden border border-[var(--border-color)]">
                    <table class="custom-table text-left">
                        <thead class="hidden md:table-header-group">
                            <tr>
                                <th class="w-1/4">Data</th>
                                <th class="w-3/4">Escalado(a) / Detalhes</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${items.map(item => {
                                let dateColor = "text-[var(--text-muted)]";
                                let rowBgStyle = "";
                                if(item.date.includes('Sáb')) { dateColor = "text-gold font-bold"; rowBgStyle = "background-color: var(--highlight-sabado-bg);"; }
                                if(item.date.includes('Dom')) { dateColor = "text-navy font-bold"; rowBgStyle = "background-color: var(--highlight-domingo-bg);"; }

                                let detailContent = `<span class="font-bold text-[var(--text-main)]">${item.name}</span>`;
                                if(item.songs) {
                                    detailContent += `<div class="mt-2 text-xs text-[var(--text-muted)]">
                                        <p class="font-semibold mb-1"><i class="fas fa-list mr-1"></i> Músicas:</p>
                                        <ul class="list-disc list-inside space-y-0.5">${item.songs.map(s => `<li>${s}</li>`).join('')}</ul>
                                    </div>`;
                                }

                                return `
                                    <tr style="${rowBgStyle}" class="flex flex-col md:table-row border-b md:border-b-0 border-[var(--border-color)] last:border-0 p-4 md:p-0">
                                        <td class="${dateColor} md:border-r border-[var(--border-color)] font-heading text-sm py-2 md:py-4 px-4 md:px-6 block md:table-cell align-top">
                                            ${item.date}
                                        </td>
                                        <td class="py-2 md:py-4 px-4 md:px-6 block md:table-cell">
                                            <div class="flex flex-col md:flex-row md:items-start">
                                                <div class="flex items-center mb-2 md:mb-0">
                                                    <div class="w-8 h-8 rounded-full bg-[var(--bg-body)] flex items-center justify-center mr-3 text-[var(--text-muted)] shadow-sm shrink-0 border border-[var(--border-color)]">
                                                        <i class="fas ${categoryData.icon} text-xs"></i>
                                                    </div>
                                                </div>
                                                <div>${detailContent}</div>
                                            </div>
                                        </td>
                                    </tr>
                                `;
                            }).join('')}
                        </tbody>
                    </table>
                </div>`;
            }
        }

        function clearSearch() {
            searchInput.value = '';
            renderContent('');
        }

        searchInput.addEventListener('input', (e) => renderContent(e.target.value));

        document.addEventListener('DOMContentLoaded', () => {
            renderTabs();
            renderContent();
        });

    </script>
</body>
</html>